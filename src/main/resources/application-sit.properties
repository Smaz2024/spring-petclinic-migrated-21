# ===================================================================
# SYSTEM INTEGRATION TEST (SIT) ENVIRONMENT CONFIGURATION
# Spring Petclinic – PostgreSQL + WildFly (SIT)
# ===================================================================

# -------------------------------------------------------------------
# DATABASE CONFIGURATION (PostgreSQL - SIT)
# -------------------------------------------------------------------
jdbc.driverClassName=org.postgresql.Driver
jdbc.url=jdbc:postgresql://sit-db-server:5432/petclinic_sit
jdbc.username=${DB_USERNAME}
jdbc.password=${DB_PASSWORD}


# -------------------------------------------------------------------
# JNDI CONFIGURATION (OPTIONAL – preferred in full WildFly setups)
# -------------------------------------------------------------------
# jdbc.jndi-name=java:jboss/datasources/PetclinicSitDS


# -------------------------------------------------------------------
# HIKARICP CONNECTION POOL (SIT - Medium pool)
# -------------------------------------------------------------------
hikari.maximum-pool-size=15
hikari.minimum-idle=3
hikari.idle-timeout=600000
hikari.connection-timeout=30000
hikari.max-lifetime=1800000
hikari.auto-commit=false
hikari.cache-prep-stmts=true
hikari.prep-stmt-cache-size=250
hikari.prep-stmt-cache-sql-limit=2048


# -------------------------------------------------------------------
# JPA / HIBERNATE CONFIGURATION (SIT - Moderate logging)
# -------------------------------------------------------------------
jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
jpa.show-sql=false
jpa.format-sql=true
jpa.hibernate.ddl-auto=validate


# -------------------------------------------------------------------
# HIBERNATE SECOND-LEVEL CACHE (ENABLED)
# -------------------------------------------------------------------
hibernate.cache.use_second_level_cache=true
hibernate.cache.use_query_cache=false
hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory
hibernate.cache.jcache.provider=com.github.benmanes.caffeine.jcache.spi.CaffeineCachingProvider
hibernate.cache.jcache.uri=classpath:caffeine-jcache.properties


# -------------------------------------------------------------------
# SPRING CACHE (Application-level caching)
# -------------------------------------------------------------------
spring.cache.type=jcache
spring.cache.cache-names=vets,specialties,petTypes


# -------------------------------------------------------------------
# CACHE CONFIGURATION (Caffeine)
# -------------------------------------------------------------------
cache.names=vets,specialties,petTypes
cache.initial-capacity=100
cache.maximum-size=400
cache.expire-after-write-minutes=10


# -------------------------------------------------------------------
# VIEW RESOLVER & STATIC RESOURCE CONFIG
# -------------------------------------------------------------------
view.prefix=/WEB-INF/jsp/
view.suffix=.jsp
static.cache-period-seconds=3600


# -------------------------------------------------------------------
# LOGGING (SIT - Balanced logging)
# -------------------------------------------------------------------
logging.level.root=INFO
logging.level.org.springframework=INFO
logging.level.org.springframework.samples.petclinic=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.cache=INFO


# -------------------------------------------------------------------
# OBSERVABILITY (SIT)
# -------------------------------------------------------------------
metrics.prometheus.enabled=true
otel.traces.sampler.type=traceidratio
otel.traces.sampler.arg=0.5
otel.exporter.otlp.endpoint=http://sit-otel-collector:4317
otel.exporter.otlp.protocol=grpc


# -------------------------------------------------------------------
# CUSTOM BUSINESS SETTINGS
# -------------------------------------------------------------------
petclinic.owner.pagesize=5


# -------------------------------------------------------------------
# ENVIRONMENT IDENTIFIER
# -------------------------------------------------------------------
environment.name=SIT
environment.color=blue
