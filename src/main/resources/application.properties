# ===================================================================
# KEY APPLICATION PROPERTIES
# Spring Petclinic – PostgreSQL + WildFly (Caching Enabled)
# ===================================================================


# -------------------------------------------------------------------
# DATABASE CONFIGURATION (PostgreSQL)
# -------------------------------------------------------------------
jdbc.driverClassName=org.postgresql.Driver
jdbc.url=jdbc:postgresql://localhost:5432/petclinic
jdbc.username=postgres
jdbc.password=postgres


# -------------------------------------------------------------------
# JNDI CONFIGURATION (OPTIONAL – preferred in full WildFly setups)
# -------------------------------------------------------------------
# jdbc.jndi-name=java:jboss/datasources/PetclinicDS


# -------------------------------------------------------------------
# HIKARICP CONNECTION POOL (Fallback when JNDI not used)
# -------------------------------------------------------------------
hikari.maximum-pool-size=20
hikari.minimum-idle=5
hikari.idle-timeout=600000
hikari.connection-timeout=30000
hikari.max-lifetime=1800000
hikari.auto-commit=false
hikari.cache-prep-stmts=true
hikari.prep-stmt-cache-size=250
hikari.prep-stmt-cache-sql-limit=2048


# -------------------------------------------------------------------
# JPA / HIBERNATE CONFIGURATION
# -------------------------------------------------------------------
jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
jpa.show-sql=false
jpa.format-sql=false
jpa.hibernate.ddl-auto=update


# -------------------------------------------------------------------
# HIBERNATE SECOND-LEVEL CACHE (ENABLED)
# -------------------------------------------------------------------
# Uses JCache (JSR-107) with Caffeine as the provider
hibernate.cache.use_second_level_cache=true
hibernate.cache.use_query_cache=false
hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

# Required for WildFly / Hibernate integration
hibernate.cache.jcache.provider=com.github.benmanes.caffeine.jcache.spi.CaffeineCachingProvider
hibernate.cache.jcache.uri=classpath:caffeine-jcache.properties


# -------------------------------------------------------------------
# SPRING CACHE (Application-level caching)
# -------------------------------------------------------------------
# Used by @Cacheable annotations in services
spring.cache.type=jcache
spring.cache.cache-names=vets,specialties,petTypes

# -------------------------------------------------------------------
# CACHE CONFIGURATION (Caffeine)
# -------------------------------------------------------------------
cache.names=vets,specialties,petTypes
cache.initial-capacity=100
cache.maximum-size=500
cache.expire-after-write-minutes=10

# -------------------------------------------------------------------
# VIEW RESOLVER & STATIC RESOURCE CONFIG
# -------------------------------------------------------------------
view.prefix=/WEB-INF/jsp/
view.suffix=.jsp
static.cache-period-seconds=31556926


# -------------------------------------------------------------------
# LOGGING
# -------------------------------------------------------------------
logging.level.root=INFO
logging.level.org.springframework=INFO
logging.level.org.springframework.samples.petclinic=DEBUG
logging.level.org.hibernate.cache=INFO


# -------------------------------------------------------------------
# OBSERVABILITY
# -------------------------------------------------------------------


# -------------------------------------------------------------------
# CUSTOM BUSINESS SETTINGS
# -------------------------------------------------------------------
petclinic.owner.pagesize=5


# -------------------------------------------------------------------
# ACTIVE PROFILE
# -------------------------------------------------------------------
spring.profiles.active=postgres
